#!/bin/bash

hasStashed=
if git-staged >/dev/null 2>&1; then
    git-stashi || exit $?
    hasStashed=t
fi
git-adduntracked && git-commit "$@"
status=$?
if [ "$hasStashed" ]; then
    git stash pop || exit $?
fi
exit $status
