#!/bin/bash

printUsage()
{
    cat <<HELPTEXT
Execute GIT-COMMAND with my own GitHub name directly appended to --PERSON-OPTION=.
HELPTEXT
    echo
    printf 'Usage: %q %s\n' "$(basename "$1")" '--PERSON-OPTION= GIT-COMMAND [...] [-?|-h|--help]'
}
case "$1" in
    --help|-h|-\?)	shift; printUsage "$0"; exit 0;;
esac

meOptionName="${1:?}"; shift
me="$(git me-in-github)" || exit $?
if [ $# -eq 0 ]; then
    echo >&2 'ERROR: No GIT-COMMAND passed.'
    exit 2
fi

typeset -a hubCommand=()
case "$1" in
    [^-]*-command)  hubCommand+=("$1"); shift
		    while [ $# -ne 0 ]
		    do
			case "$1" in
			    --)		break;;
			    -*)		hubCommand+=("$1"); shift;;
			    *)		hubCommand+=("$1"); shift; break;;
			esac
		    done
		    ;;
    *)		    while [ $# -ne 0 ]
		    do
			case "$1" in
			    -c) hubCommand+=("$1" "$2"); shift; shift;;
			    *)	hubCommand+=("$1"); shift; break;;
			esac
		    done
esac

exec hub-wrapper "${hubCommand[@]}" "${meOptionName}${me}" "$@"
