#!/bin/bash

git commit "$@" || exit $?

if [ -t 1 ]; then
    : ${GIT_COMMIT_NOTE_PREFIX=[3;36m}
    : ${GIT_COMMIT_NOTE_SUFFIX=[0m}

    root="$(git rev-parse --show-toplevel)" || exit 0
    printf >/dev/tty '%sReuse this commit message via $ git inside lo1 -- %s%s\n' "$GIT_COMMIT_NOTE_PREFIX" "${root/#${HOME}\//~\/}" "$GIT_COMMIT_NOTE_SUFFIX"

    if git-existsremote origin && commitUrl="$(git lourl1)" && [ -n "$commitUrl" ]; then
	printf >/dev/tty '%sView this commit in %s: %s%s\n' "$GIT_COMMIT_NOTE_PREFIX" 'origin' "$commitUrl" "$GIT_COMMIT_NOTE_SUFFIX"
    fi
fi
