#!/bin/sh

printUsage()
{
    cat <<HELPTEXT
List all git command extensions and newly defined commands. 
Usage: "$(basename "$1")" [-?|-h|--help]
HELPTEXT
}
case "$1" in
    --help|-h|-\?)	shift; printUsage "$0"; exit 0;;
esac

sed \
    -e '
	/^\[alias\]/,/^\[/{
	    /^\[alias\]/d;
	    /^\[/Q;

	    # Remove indent. 
	    s/^[ \t]*//;

	    # Keep special comments, and break keyword and explanation into
	    # separate lines. 
	    s/^;; \([^:]\+\):[ \t]*\(.*\)/\1\n\t\2/

	    # Remove all other comment lines. 
	    /^;/d;

	    # Break alias definition and alias comment into separate lines. 
	    s/[ \t]=[ \t][^;]*[ \t];[ \t]*/\n\t/;
	    b
	}' \
    ~/.gitconfig \
    | sed -e '/^\t/!s/[^=]*/[01m&[0m/' -e '/^\t/s/^\t//' | less --RAW-CONTROL-CHARS
